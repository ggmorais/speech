(this.webpackJsonpspeech=this.webpackJsonpspeech||[]).push([[0],{12:function(e,t,n){e.exports={label:"Input_label__3AyPt",inputName:"Input_inputName__3yOlU",input:"Input_input__2KyBj"}},13:function(e,t,n){e.exports={container:"Button_container__KwHpc",done:"Button_done__Kqm8x",cancel:"Button_cancel__3vr-R"}},14:function(e,t,n){e.exports={cover:"Layer_cover__3oMgi",content:"Layer_content__2Z31y",container:"Layer_container__3TJSY"}},20:function(e,t,n){e.exports={warning:"labels_warning__3FGrD",buttonCancel:"labels_buttonCancel__1S3W1",buttonDone:"labels_buttonDone__1ApdZ"}},21:function(e,t,n){e.exports={container:"chat_container__14tFz",blockLeft:"chat_blockLeft__3DcdR"}},22:function(e,t,n){e.exports={container:"window_container__j9QA_",window:"window_window__2Z0Ow",newMessage:"window_newMessage__2nlXw",messageList:"window_messageList__1Q4lt",messageInfos:"window_messageInfos__1_6WM",message:"window_message__1m09J",messageOwner:"window_messageOwner__3--RG",messageBody:"window_messageBody__2K7J-"}},23:function(e,t,n){e.exports={container:"logoff_container__3aTQ6",username:"logoff_username__t699w"}},24:function(e,t,n){e.exports={container:"login_container__2zjBj",form:"login_form__2_2Ge",label:"login_label__3rd20",inputName:"login_inputName__1Fa_J",input:"login_input__2F9pF"}},42:function(e,t,n){e.exports={container:"Loading_container__1qrMu"}},43:function(e,t,n){e.exports={container:"Warning_container__18O9h"}},44:function(e,t,n){e.exports={container:"newroom_container__32UHt",buttons:"newroom_buttons__2wspF"}},45:function(e,t,n){e.exports={form:"enter_form__A8WpN",label:"enter_label__1FvyZ",inputName:"enter_inputName__3jwgx",input:"enter_input__25nPH",buttons:"enter_buttons__3sKnw",buttonOpen:"enter_buttonOpen__Swegm"}},47:function(e,t,n){e.exports={container:"app_container__1EPu7"}},49:function(e,t,n){e.exports=n(90)},6:function(e,t,n){e.exports={messageList:"Message_messageList__1qXvk",messageInfos:"Message_messageInfos__wHPB4",message:"Message_message__39klB",messageOwner:"Message_messageOwner__FfaNP",messageBody:"Message_messageBody__3g_pO",postDate:"Message_postDate__3i1MH"}},8:function(e,t,n){e.exports={container:"list_container__TWbm_",roomName:"list_roomName__PQFcM",lastMessage:"list_lastMessage__31FNT",postDate:"list_postDate__2AWzd"}},83:function(e,t){},89:function(e,t,n){},9:function(e,t,n){e.exports={container:"NewMessage_container__3-Wiw",flex:"NewMessage_flex__2MGxh",input:"NewMessage_input__1igAV",button:"NewMessage_button__1QnQY"}},90:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(41),o=n.n(s),c=(n(54),n(1)),l=n.n(c),i=n(2),u=n(21),m=n.n(u),_=n(8),d=n.n(_),p=function(e){return r.a.createElement("div",{className:d.a.container,onClick:e.handleSelect.bind(void 0,e._id)},r.a.createElement("p",{className:d.a.roomName},e.name),r.a.createElement("p",{className:d.a.lastMessage},e.lastMessage&&e.sender+": "+e.lastMessage,r.a.createElement("span",{className:d.a.postDate},e.postDate)))},g="http://speech-restapi.herokuapp.com/api",f=n(48),h=n(7),w=n.n(h),b=Object(a.createContext)(),v=function(e){var t=localStorage.getItem("@speech/token"),n=w()(t),s=Object(a.useState)([]),o=Object(i.a)(s,2),c=o[0],u=o[1],m=Object(a.useState)(localStorage.getItem("@speech/room")),_=Object(i.a)(m,2),d=_[0],p=_[1];return Object(a.useEffect)((function(){!function(){var e,a,r,s,o,i,m;l.a.async((function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,l.a.awrap(fetch(g+"/rooms/"+n._id,{headers:{authorization:t}}));case 2:return e=_.sent,_.next=5,l.a.awrap(e.json());case 5:if(a=_.sent,0!==c.length){_.next=10;break}u(a.rooms),_.next=29;break;case 10:for(r=!0,s=!1,o=void 0,_.prev=13,i=a.rooms[Symbol.iterator]();!(r=(m=i.next()).done);r=!0)m.value;_.next=21;break;case 17:_.prev=17,_.t0=_.catch(13),s=!0,o=_.t0;case 21:_.prev=21,_.prev=22,r||null==i.return||i.return();case 24:if(_.prev=24,!s){_.next=27;break}throw o;case 27:return _.finish(24);case 28:return _.finish(21);case 29:case"end":return _.stop()}}),null,null,[[13,17,21,29],[22,,24,28]])}()}),[]),r.a.createElement(b.Provider,{value:{user:n,rooms:c,token:t,updateRoom:function(e,t){var a=Object(f.a)(c);for(var r in a)a[r]._id===e&&(a[r].messages.push({postDate:Date.now(),_id:a[r].messages.length+1,user:n,body:t}),u((function(){return a})))},selectedRoom:d,selectRoom:function(e){localStorage.setItem("@speech/room",e),p(e)}}},e.children)},E=n(12),y=n.n(E),N=n(13),x=n.n(N),C=n(14),k=n.n(C),S=n(9),O=n.n(S),j=n(6),M=n.n(j),D=n(42),I=n.n(D),L=n(43),R=n.n(L),B=function(e){return r.a.createElement("div",{className:y.a.label},r.a.createElement("p",{className:y.a.inputName},e.title),r.a.createElement("input",{style:{borderRadius:e.rounded&&e.rounded,width:e.width&&e.width},className:y.a.input,type:e.type,name:e.name,onChange:e.onChange,value:e.value}))},T=function(e){return r.a.createElement("p",{className:x.a.container},r.a.createElement("button",{onClick:e.onClick,className:e.cancel?x.a.cancel:x.a.done,style:{width:e.width&&e.width,borderRadius:e.rounded&&e.rounded}},e.title))},P=function(e){return r.a.createElement("div",{className:k.a.cover,style:{display:!e.show&&"none"}},r.a.createElement("div",{className:k.a.content},r.a.createElement("div",{className:k.a.container,style:{padding:e.pd&&e.pd}},e.children)))},z=function(e){return r.a.createElement("div",{className:O.a.container},r.a.createElement("div",{className:O.a.flex},r.a.createElement("input",{className:O.a.input,type:"text",value:e.value,onChange:e.onChange}),r.a.createElement("button",{className:O.a.button,onClick:e.onClick},"OK")))},F=function(e){return r.a.createElement("li",{className:M.a.messageInfos,style:{justifyContent:e.right&&"flex-end"}},r.a.createElement("div",{className:M.a.message},r.a.createElement("a",{className:M.a.messageOwner},e.username),r.a.createElement("p",{className:M.a.messageBody},e.body," ",r.a.createElement("span",{className:M.a.postDate},e.postDate))))},J=function(e){return r.a.createElement("div",{className:I.a.container,style:{height:e.size&&e.size,width:e.use&&e.use,display:e.hide&&"none",marginTop:e.top&&e.top,marginLeft:e.left&&e.left,marginRight:e.right&&e.right,marginBottom:e.bottom&&e.bottom}})},A=function(e){return r.a.createElement("div",{className:R.a.container,style:{marginTop:e.top&&e.top}},e.children)},H=function(e){var t=new Date(e);return t=t.getHours()+":"+t.getMinutes()},W=function(e){var t=Object(a.useContext)(b),n=t.rooms,s=t.selectRoom,o=(t.selectedRoom,t.user),c=function(e){s(e)};return n.length?n.map((function(e){var t,n,a;return e.messages.length>0&&(t=e.messages[e.messages.length-1].user.username,n=e.messages[e.messages.length-1].body,a=e.messages[e.messages.length-1].postDate,n.length>=30&&(n=n.slice(0,30)+" ..."),e.messages[e.messages.length-1].user.username===o.username&&(t="You")),console.log(e),r.a.createElement(p,Object.assign({},e,{key:e._id,handleSelect:c,username:o.username,sender:t,lastMessage:n,postDate:a&&H(a)}))})):r.a.createElement(J,null)},K=function(e){return r.a.createElement(W,null)},Q=n(22),G=n.n(Q),Z=function(e){var t=r.a.useState(""),n=Object(i.a)(t,2),a=n[0],s=n[1],o=r.a.useContext(b),c=o.rooms,u=o.token,m=(o.fetchRooms,o.user),_=o.updateRoom,d=o.selectedRoom,p=[];if(c.length){var f=!0,h=!1,w=void 0;try{for(var v,E=c[Symbol.iterator]();!(f=(v=E.next()).done);f=!0){var y=v.value;y._id===d&&(p=y.messages)}}catch(N){h=!0,w=N}finally{try{f||null==E.return||E.return()}finally{if(h)throw w}}}return r.a.createElement("div",{className:G.a.container},r.a.createElement("div",{className:G.a.window},p.length?p.map((function(e){return r.a.createElement("ul",{id:"messagesList"},r.a.createElement(F,{key:e._id,username:e.user.username!==m.username&&e.user.username,right:e.user.username===m.username&&!0,body:e.body,postDate:H(e.postDate)}))})):r.a.createElement(A,{top:"25%"},"This room does not have messages yet, be the first sanding one now!"),r.a.createElement(z,{onChange:function(e){s(e.target.value)},onClick:function(e){return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=2;break}return e.abrupt("return");case 2:return _(d,a),s(""),e.next=6,l.a.awrap(fetch(g+"/rooms/"+d,{method:"PATCH",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({userId:m._id,body:a})}));case 6:e.sent;case 7:case"end":return e.stop()}}))},value:a})))},q=function(e){return r.a.createElement(Z,null)},U=n(23),Y=n.n(U),X=function(e){return r.a.createElement("div",{className:Y.a.container},r.a.createElement("p",{className:Y.a.username},e.username),r.a.createElement(T,{cancel:!0,width:"90%",title:"Log out",onClick:e.handleButton}))},V=function(e){var t=r.a.useContext(b).user;return r.a.createElement(X,{handleButton:function(e){e.preventDefault(),localStorage.setItem("@speech/token",!1)},username:t.username})},$=function(e){return r.a.createElement(V,e)},ee=n(44),te=n.n(ee),ne=function(e){return r.a.createElement("div",null,r.a.createElement(T,{title:"Create room",onClick:e.handleLayer}),r.a.createElement(P,{show:e.layer},r.a.createElement("p",null,e.layer," "),r.a.createElement(B,{title:"Room name",type:"text",name:"name",value:e.roomName,onChange:e.handleChanges}),r.a.createElement("div",{className:te.a.buttons},r.a.createElement(T,{cancel:!0,title:"Cancel",onClick:e.handleLayer}),r.a.createElement(T,{title:"Create",onClick:e.handleSubmit}))))},ae=function(e){var t=r.a.useState(!1),n=Object(i.a)(t,2),a=n[0],s=n[1],o=r.a.useState(""),c=Object(i.a)(o,2),u=c[0],m=c[1],_=r.a.useContext(b),d=_.user,p=_.fetchRooms;return r.a.createElement(ne,{roomName:u,handleChanges:function(e){m(e.target.value)},handleSubmit:function(e){return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,l.a.awrap(fetch(g+"/rooms",{method:"POST",headers:{"Content-Type":"application/json",authorization:localStorage.getItem("@speech/token")},body:JSON.stringify({name:u,userId:d._id})}));case 3:200===t.sent.status&&p();case 5:case"end":return t.stop()}}))},handleLayer:function(e){s(!a)},layer:a})},re=function(e){return r.a.createElement(ae,null)},se=n(45),oe=n.n(se),ce=n(20),le=n.n(ce),ie=function(e){return r.a.createElement("div",null,r.a.createElement(T,{title:"Enter room",onClick:e.handleLayer}),r.a.createElement(P,{show:e.layer},r.a.createElement(B,{type:"text",name:"roomId",title:"Room ID",onChange:e.handleChanges}),r.a.createElement("div",{className:oe.a.buttons},r.a.createElement(T,{cancel:!0,title:"Cancel",onClick:e.handleLayer}),r.a.createElement(T,{title:"Enter",onClick:e.handleSubmit}))))},ue=function(e){var t=r.a.useState(!1),n=Object(i.a)(t,2),a=n[0],s=n[1],o=r.a.useState(""),c=Object(i.a)(o,2),l=c[0],u=c[1];return r.a.createElement(ie,{layer:a,handleLayer:function(e){s(!a)},handleChanges:function(e){u(e.target.value)},handleSubmit:function(e){e.preventDefault(),alert("entrando na sala id ",l)}})},me=function(e){return r.a.createElement(ue,null)},_e=function(e){return r.a.createElement("div",{className:m.a.container},r.a.createElement("div",{className:m.a.blockLeft},r.a.createElement($,null),r.a.createElement(me,null),r.a.createElement(re,null),r.a.createElement(K,null)),r.a.createElement(q,null))},de=n(5),pe=n(46),ge=n(24),fe=n.n(ge),he=function(e){return r.a.createElement("div",{className:fe.a.container},r.a.createElement("p",{className:le.a.warning,style:{display:e.message?"block":"none"}},e.message),r.a.createElement("form",{className:fe.a.form,onSubmit:e.handleSubmit},r.a.createElement(B,{title:"Username",type:"text",name:"username",onChange:e.handleChanges,value:e.changes.username}),r.a.createElement(B,{title:"Password",type:"password",name:"password",onChange:e.handleChanges,value:e.changes.password}),r.a.createElement(T,{title:"Login",width:"80%"})))},we=function(e){var t=r.a.useState({username:"",password:""}),n=Object(i.a)(t,2),a=n[0],s=n[1],o=r.a.useState(""),c=Object(i.a)(o,2),u=c[0],m=c[1];return r.a.createElement(he,{changes:a,handleChanges:function(e){var t=e.target,n=t.name,r=t.value;"undefined"!==typeof a[n]&&s(Object(pe.a)({},a,Object(de.a)({},n,r)))},handleSubmit:function(t){var n,r,o,c,i;return l.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return t.preventDefault(),u.next=3,l.a.awrap(fetch(g+"/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}));case 3:return n=u.sent,r=n.status,u.next=7,l.a.awrap(n.json());case 7:o=u.sent,c=o.message,i=o.token,401===r?(m(c),s({username:"",password:""})):200===r&&(localStorage.setItem("@speech/token",i),e.show(!1));case 11:case"end":return u.stop()}}))},message:u})},be=function(e){return r.a.createElement(we,e)},ve=function(){var e=window.location.hash;if(e.length<=1)return!1;if(e.includes("=")){var t=(e=e.substr(1,e.length)).split("=");return Object(de.a)({},t[0],t[1])}return!1},Ee=function(e){var t=r.a.useState(!0),n=Object(i.a)(t,2),a=n[0],s=n[1],o=localStorage.getItem("@speech/token"),c=ve();return r.a.useEffect((function(){o?function(){var e,t,n;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!((e=localStorage.getItem("@speech/token")).length<10)){a.next=3;break}return a.abrupt("return",!1);case 3:return a.next=5,l.a.awrap(fetch(g+"/users/validation",{headers:{authorization:e}}));case 5:return t=a.sent,n=t.status,a.abrupt("return",401!==n);case 8:case"end":return a.stop()}}))}().then((function(e){e?s(!1):(localStorage.removeItem("@speech/token"),s(!0))})):s(!0)}),[]),c.room?(function(){var e;l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.awrap(fetch(g+"/rooms/e/"+c.room,{method:"PATCH",headers:{"Content-Type":"application/json",authorization:o},body:JSON.stringify({userId:w()(o)._id})}));case 2:e=t.sent,console.log(window.location.host),200===e.status&&(localStorage.setItem("@speech/room",c.room),window.location.replace("http://localhost:3000"));case 5:case"end":return t.stop()}}))}(),r.a.createElement("div",null)):a?r.a.createElement(be,{show:s}):r.a.createElement(v,null,r.a.createElement(_e,null))},ye=function(){return r.a.createElement(Ee,null)},Ne=n(47),xe=n.n(Ne);var Ce=function(){return r.a.createElement("div",{className:xe.a.container},r.a.createElement(ye,null))};n(89);o.a.render(r.a.createElement(Ce,null),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.b3978018.chunk.js.map